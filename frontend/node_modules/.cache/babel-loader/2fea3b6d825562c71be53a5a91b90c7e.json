{"ast":null,"code":"var _jsxFileName = \"E:\\\\TLCN\\\\LearningEnglishWebsite\\\\frontend\\\\src\\\\pages\\\\EditUser.js\",\n    _s = $RefreshSig$();\n\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport Button from \"@material-ui/core/Button\";\nimport Grid from \"@material-ui/core/Grid\";\nimport LoopIcon from \"@material-ui/icons/Loop\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport InputCustom from \"components/UI/InputCustom\";\nimport SelectCustom from \"components/UI/SelectCustom\";\nimport { ROUTES, ROLE_TYPE } from \"constants/index\";\nimport React, { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useDispatch } from \"react-redux\";\nimport { setMessage } from \"redux/actions/messageAction\";\nimport * as yup from \"yup\";\nimport { useHistory } from \"react-router-dom\";\nimport CameraIcon from \"@material-ui/icons/PhotoCamera\";\nimport { convertImageToBase64 } from \"helper/index\";\nimport useTitle from \"hooks/useTitle\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport userApi from 'apis/userApi';\nimport { useParams } from 'react-router';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst nameRegex = /^[^\\d~`!@#$%^&*\\(\\)\\\\\\|\\.,\\?\\/\\-\\+\\=\\_]+$/gi;\nconst schema = yup.object().shape({\n  email: yup.string().trim().required(\"Nhập email\").email(\"Email không hợp lệ\"),\n  name: yup.string().trim().required(\"Nhập họ tên\").matches(nameRegex, \"Họ tên không chứa số và ký tự đặc biệt\")\n});\nconst useStyle = makeStyles(() => ({\n  wrap: {\n    minHeight: \"calc(100vh - 7.2rem)\"\n  },\n  root: {\n    backgroundColor: \"var(--bg-color-sec)\",\n    padding: \"1.5rem 2.5rem\",\n    borderRadius: \"var(--border-radius)\",\n    textAlign: \"center\",\n    boxShadow: \"var(--box-shadow)\"\n  },\n  avtWrap: {\n    width: \"15rem\",\n    height: \"15rem\",\n    position: \"relative\"\n  },\n  avt: {\n    borderRadius: \"50%\",\n    border: \"2px solid var(--primary-color)\"\n  },\n  cameraIconWrap: {\n    position: \"absolute\",\n    right: 0,\n    bottom: 0,\n    width: \"4.2rem\",\n    height: \"4.2rem\",\n    padding: \"1.2rem\",\n    backgroundColor: \"var(--primary-color)\",\n    borderRadius: \"50%\",\n    cursor: \"pointer\",\n    border: \"solid 5px var(--bg-color-sec)\",\n    \"&:hover, &:active\": {\n      opacity: 0.85\n    }\n  },\n  cameraIcon: {\n    color: \"var(--text-color)\",\n    fontSize: \"2rem\"\n  },\n  fileInput: {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\",\n    top: 0,\n    left: 0,\n    opacity: 0,\n    cursor: \"pointer\"\n  },\n  name: {\n    fontSize: \"2.4rem\",\n    lineHeight: 1.5,\n    letterSpacing: \"0.75px\"\n  },\n  role: {\n    fontSize: \"1.5rem\",\n    fontWeight: 400,\n    color: \"var(--label-color)\",\n    letterSpacing: \"0.75px\",\n    textTransform: \"capitalize\"\n  },\n  info: {\n    margin: \"2.4rem 0\",\n    \"& p\": {\n      lineHeight: 2,\n      fontSize: \"1.6rem\",\n      letterSpacing: \"0.75px\",\n      color: \"var(--text-color)\"\n    }\n  },\n  coin: {\n    color: \"var(--label-color)\",\n    fontWeight: \"bold\",\n    fontSize: \"2rem\"\n  },\n  icon: {\n    fontSize: \"1.8rem\",\n    color: \"var(--grey)\",\n    cursor: \"pointer\"\n  },\n  visiblePw: {\n    color: \"var(--primary-color)\"\n  },\n  visibleConfirmPw: {\n    color: \"var(--primary-color)\"\n  },\n  editBtn: {\n    padding: \"5px 10px\"\n  },\n  textError: {\n    marginTop: \"4px\",\n    color: \"var(--error-color)\",\n    fontSize: \"1.2rem\",\n    textAlign: \"left\"\n  }\n}));\n\nfunction EditUserPage() {\n  _s();\n\n  var _errors$email, _errors$name;\n\n  useTitle(\"Edit user\");\n  const classes = useStyle();\n  const defaultImg = \"https://res.cloudinary.com/phongvn2611/image/upload/v1634179173/english/avatar/avatar-default_tx5lsb.png\";\n  const [submitting, setSubmitting] = useState(false);\n  const {\n    user_id\n  } = useParams();\n  const [initEmail, setInitEmail] = useState(null);\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    }\n  } = useForm({\n    resolver: yupResolver(schema)\n  });\n  const [user, setUser] = useState({});\n  const [avatar, setAvatar] = useState(null);\n  useEffect(() => {\n    (async function () {\n      const res = await userApi.getUserDetails(user_id);\n      setUser(res.data.user);\n      setInitEmail(res.data.user.email);\n      setAvatar(res.data.user.avatar);\n    })();\n\n    return () => {};\n  }, [user_id]);\n\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setUser({ ...user,\n      [name]: value\n    });\n  };\n\n  const handleChangeAvatar = e => {\n    e.preventDefault();\n\n    try {\n      const file = e.target.files[0];\n\n      if (!file) {\n        dispatch(setMessage(\"No files were uploaded\", \"errors\"));\n      }\n\n      if (file.size / 1024 ** 2 > 2) {\n        dispatch(setMessage(\"Size too large\", \"errors\"));\n      }\n\n      convertImageToBase64(file).then(res => {\n        setAvatar(res);\n      });\n    } catch (err) {\n      throw err;\n    }\n  };\n\n  const handleEditUser = async () => {\n    try {\n      setSubmitting(true);\n      const dataSend = {\n        name: user.name,\n        email: user.email,\n        avatar,\n        role: user.roleType,\n        initEmail\n      };\n      const res = await userApi.editUser(user_id, dataSend);\n\n      if (res) {\n        dispatch(setMessage(res.data.message, 'success'));\n        setSubmitting(false);\n        history.replace(`/admin/user/detail/${user_id}`);\n      }\n    } catch (error) {\n      dispatch(setMessage(error.response.data.message, 'error'));\n      setSubmitting(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `${classes.wrap} container flex-center`,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.root,\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        autoComplete: \"off\",\n        onSubmit: handleSubmit(handleEditUser),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-center w-100 h-100\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.avtWrap,\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: avatar ? avatar : defaultImg,\n              alt: \"\",\n              className: `${classes.avt} w-100 h-100`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `${classes.cameraIconWrap} flex-center`,\n              children: [/*#__PURE__*/_jsxDEV(CameraIcon, {\n                className: classes.cameraIcon\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                className: classes.fileInput,\n                accept: \"image/*\",\n                onChange: handleChangeAvatar\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-col mt-10\",\n          children: [/*#__PURE__*/_jsxDEV(InputCustom, {\n            label: \"Email\",\n            size: \"small\",\n            placeholder: \"Nh\\u1EADp email\",\n            value: user.email ? user.email : '',\n            error: Boolean(errors.email),\n            inputProps: {\n              name: \"email\",\n              autoFocus: true,\n              ...register(\"email\")\n            },\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 13\n          }, this), errors.email && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-error\",\n            children: (_errors$email = errors.email) === null || _errors$email === void 0 ? void 0 : _errors$email.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(InputCustom, {\n            label: \"H\\u1ECD t\\xEAn\",\n            size: \"small\",\n            placeholder: \"Nh\\u1EADp h\\u1ECD t\\xEAn\",\n            className: \"mt-10\",\n            value: user.name ? user.name : '',\n            error: Boolean(errors.name),\n            inputProps: {\n              name: \"name\",\n              ...register(\"name\")\n            },\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 13\n          }, this), errors.name && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-error\",\n            children: (_errors$name = errors.name) === null || _errors$name === void 0 ? void 0 : _errors$name.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(SelectCustom, {\n            className: \"mt-10\",\n            label: \"Quy\\u1EC1n\",\n            options: ROLE_TYPE,\n            value: user.roleType ? user.roleType : '',\n            inputProps: {\n              name: \"roleType\"\n            },\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex-center flex-center-col mt-10\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            className: `${classes.editBtn} _btn _btn-outlined-accent mb-4 w-100`,\n            onClick: () => history.replace(`/admin/user/detail/${user_id}`),\n            children: \"Quay l\\u1EA1i\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            className: `${classes.editBtn} _btn _btn-primary w-100`,\n            disabled: submitting,\n            endIcon: submitting ? /*#__PURE__*/_jsxDEV(LoopIcon, {\n              className: \"ani-spin\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 30\n            }, this) : /*#__PURE__*/_jsxDEV(SaveIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 66\n            }, this),\n            variant: \"contained\",\n            children: \"S\\u1EEDa\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 219,\n    columnNumber: 5\n  }, this);\n}\n\n_s(EditUserPage, \"1z8h2LUjx7vFsbxbSZrgEFlAwxw=\", false, function () {\n  return [useTitle, useStyle, useParams, useHistory, useDispatch, useForm];\n});\n\n_c = EditUserPage;\nexport default EditUserPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditUserPage\");","map":{"version":3,"sources":["E:/TLCN/LearningEnglishWebsite/frontend/src/pages/EditUser.js"],"names":["yupResolver","Button","Grid","LoopIcon","SaveIcon","InputCustom","SelectCustom","ROUTES","ROLE_TYPE","React","useState","useEffect","useForm","useDispatch","setMessage","yup","useHistory","CameraIcon","convertImageToBase64","useTitle","makeStyles","userApi","useParams","nameRegex","schema","object","shape","email","string","trim","required","name","matches","useStyle","wrap","minHeight","root","backgroundColor","padding","borderRadius","textAlign","boxShadow","avtWrap","width","height","position","avt","border","cameraIconWrap","right","bottom","cursor","opacity","cameraIcon","color","fontSize","fileInput","top","left","lineHeight","letterSpacing","role","fontWeight","textTransform","info","margin","coin","icon","visiblePw","visibleConfirmPw","editBtn","textError","marginTop","EditUserPage","classes","defaultImg","submitting","setSubmitting","user_id","initEmail","setInitEmail","history","dispatch","register","handleSubmit","formState","errors","resolver","user","setUser","avatar","setAvatar","res","getUserDetails","data","handleChange","e","value","target","handleChangeAvatar","preventDefault","file","files","size","then","err","handleEditUser","dataSend","roleType","editUser","message","replace","error","response","Boolean","autoFocus"],"mappings":"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","sourcesContent":["import { yupResolver } from \"@hookform/resolvers/yup\";\nimport Button from \"@material-ui/core/Button\";\nimport Grid from \"@material-ui/core/Grid\";\nimport LoopIcon from \"@material-ui/icons/Loop\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport InputCustom from \"components/UI/InputCustom\";\nimport SelectCustom from \"components/UI/SelectCustom\";\nimport { ROUTES, ROLE_TYPE } from \"constants/index\";\nimport React, { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useDispatch } from \"react-redux\";\nimport { setMessage } from \"redux/actions/messageAction\";\nimport * as yup from \"yup\";\nimport { useHistory } from \"react-router-dom\";\nimport CameraIcon from \"@material-ui/icons/PhotoCamera\";\nimport { convertImageToBase64 } from \"helper/index\";\nimport useTitle from \"hooks/useTitle\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport userApi from 'apis/userApi';\nimport { useParams } from 'react-router';\n\nconst nameRegex = /^[^\\d~`!@#$%^&*\\(\\)\\\\\\|\\.,\\?\\/\\-\\+\\=\\_]+$/gi;\nconst schema = yup.object().shape({\n  email: yup.string().trim().required(\"Nhập email\").email(\"Email không hợp lệ\"),\n  name: yup\n    .string()\n    .trim()\n    .required(\"Nhập họ tên\")\n    .matches(nameRegex, \"Họ tên không chứa số và ký tự đặc biệt\"),\n});\n\nconst useStyle = makeStyles(() => ({\n  wrap: {\n    minHeight: \"calc(100vh - 7.2rem)\",\n  },\n\n  root: {\n    backgroundColor: \"var(--bg-color-sec)\",\n    padding: \"1.5rem 2.5rem\",\n    borderRadius: \"var(--border-radius)\",\n    textAlign: \"center\",\n    boxShadow: \"var(--box-shadow)\",\n  },\n\n  avtWrap: {\n    width: \"15rem\",\n    height: \"15rem\",\n    position: \"relative\",\n  },\n\n  avt: {\n    borderRadius: \"50%\",\n    border: \"2px solid var(--primary-color)\",\n  },\n\n  cameraIconWrap: {\n    position: \"absolute\",\n    right: 0,\n    bottom: 0,\n\n    width: \"4.2rem\",\n    height: \"4.2rem\",\n    padding: \"1.2rem\",\n\n    backgroundColor: \"var(--primary-color)\",\n    borderRadius: \"50%\",\n    cursor: \"pointer\",\n    border: \"solid 5px var(--bg-color-sec)\",\n\n    \"&:hover, &:active\": {\n      opacity: 0.85,\n    },\n  },\n\n  cameraIcon: {\n    color: \"var(--text-color)\",\n    fontSize: \"2rem\",\n  },\n\n  fileInput: {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\",\n    top: 0,\n    left: 0,\n    opacity: 0,\n    cursor: \"pointer\",\n  },\n\n  name: {\n    fontSize: \"2.4rem\",\n    lineHeight: 1.5,\n    letterSpacing: \"0.75px\",\n  },\n\n  role: {\n    fontSize: \"1.5rem\",\n    fontWeight: 400,\n    color: \"var(--label-color)\",\n    letterSpacing: \"0.75px\",\n    textTransform: \"capitalize\",\n  },\n\n  info: {\n    margin: \"2.4rem 0\",\n\n    \"& p\": {\n      lineHeight: 2,\n      fontSize: \"1.6rem\",\n      letterSpacing: \"0.75px\",\n      color: \"var(--text-color)\",\n    },\n  },\n\n  coin: {\n    color: \"var(--label-color)\",\n    fontWeight: \"bold\",\n    fontSize: \"2rem\",\n  },\n  icon: {\n    fontSize: \"1.8rem\",\n    color: \"var(--grey)\",\n    cursor: \"pointer\",\n  },\n\n  visiblePw: {\n    color: \"var(--primary-color)\",\n  },\n  visibleConfirmPw: {\n    color: \"var(--primary-color)\",\n  },\n  editBtn: {\n    padding: \"5px 10px\",\n  },\n  textError: {\n    marginTop: \"4px\",\n    color: \"var(--error-color)\",\n    fontSize: \"1.2rem\",\n    textAlign: \"left\",\n  },\n}));\n\nfunction EditUserPage() {\n  useTitle(\"Edit user\");\n  const classes = useStyle();\n  const defaultImg =\n    \"https://res.cloudinary.com/phongvn2611/image/upload/v1634179173/english/avatar/avatar-default_tx5lsb.png\";\n  const [submitting, setSubmitting] = useState(false);\n  const { user_id } = useParams();\n  const [initEmail, setInitEmail] = useState(null);\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm({\n    resolver: yupResolver(schema),\n  });\n\n  const [user, setUser] = useState({});\n\n  const [avatar, setAvatar] = useState(null);\n  useEffect(() => {\n    (async function () {\n      const res = await userApi.getUserDetails(user_id);\n      setUser(res.data.user);\n      setInitEmail(res.data.user.email);\n      setAvatar(res.data.user.avatar)\n    })();\n    return () => {};\n  }, [user_id]);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setUser({ ...user, [name]: value });\n  };\n  const handleChangeAvatar = (e) => {\n    e.preventDefault();\n    try {\n      const file = e.target.files[0];\n      if (!file) {\n        dispatch(setMessage(\"No files were uploaded\", \"errors\"));\n      }\n      if (file.size / 1024 ** 2 > 2) {\n        dispatch(setMessage(\"Size too large\", \"errors\"));\n      }\n      convertImageToBase64(file).then((res) => {\n        setAvatar(res);\n      });\n    } catch (err) {\n      throw err;\n    }\n  };\n  const handleEditUser = async () => {\n    try {\n      setSubmitting(true);\n      const dataSend = {\n        name: user.name,\n        email: user.email,\n        avatar,\n        role: user.roleType,\n        initEmail\n      }\n      const res = await userApi.editUser(user_id, dataSend);\n      if (res) {\n        dispatch(setMessage(res.data.message, 'success'));\n        setSubmitting(false);\n        history.replace(`/admin/user/detail/${user_id}`)\n      }\n    }\n    catch (error) {\n      dispatch(setMessage(error.response.data.message, 'error'));\n      setSubmitting(false);\n    }\n  }\n\n  return (\n    <div className={`${classes.wrap} container flex-center`}>\n      <div className={classes.root}>\n        <form autoComplete=\"off\" onSubmit={handleSubmit(handleEditUser)}>\n          <div className=\"flex-center w-100 h-100\">\n            <div className={classes.avtWrap}>\n              <img\n                src={avatar ? avatar : defaultImg}\n                alt=\"\"\n                className={`${classes.avt} w-100 h-100`}\n              />\n              <div className={`${classes.cameraIconWrap} flex-center`}>\n                <CameraIcon className={classes.cameraIcon} />\n                <input\n                  type=\"file\"\n                  className={classes.fileInput}\n                  accept=\"image/*\"\n                  onChange={handleChangeAvatar}\n                />\n              </div>\n            </div>\n          </div>\n          <div className=\"flex-col mt-10\">\n            <InputCustom\n              label=\"Email\"\n              size=\"small\"\n              placeholder=\"Nhập email\"\n              value={user.email ? user.email : ''}\n              error={Boolean(errors.email)}\n              inputProps={{\n                name: \"email\",\n                autoFocus: true,\n                ...register(\"email\"),\n              }}\n              onChange={handleChange}\n            />\n            {errors.email && (\n              <p className=\"text-error\">{errors.email?.message}</p>\n            )}\n            <InputCustom\n              label=\"Họ tên\"\n              size=\"small\"\n              placeholder=\"Nhập họ tên\"\n              className=\"mt-10\"\n              value={user.name ? user.name : ''}\n              error={Boolean(errors.name)}\n              inputProps={{\n                name: \"name\",\n                ...register(\"name\"),\n              }}\n              onChange={handleChange}\n            />\n            {errors.name && (\n              <p className=\"text-error\">{errors.name?.message}</p>\n            )}\n            \n            <SelectCustom\n              className=\"mt-10\"\n              label=\"Quyền\"\n              options={ROLE_TYPE}\n              value={user.roleType ? user.roleType : ''}\n              inputProps={{\n                name: \"roleType\",\n              }}\n              onChange={handleChange}\n            />\n          </div>\n\n          <div className=\"d-flex-center flex-center-col mt-10\">\n            <Button\n              className={`${classes.editBtn} _btn _btn-outlined-accent mb-4 w-100`}\n              onClick={() => history.replace(`/admin/user/detail/${user_id}`)}\n            >\n              Quay lại\n            </Button>\n            <Button\n              type=\"submit\"\n              className={`${classes.editBtn} _btn _btn-primary w-100`}\n              disabled={submitting}\n              endIcon={\n                submitting ? <LoopIcon className=\"ani-spin\" /> : <SaveIcon />\n              }\n              variant=\"contained\"\n            >\n              Sửa\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default EditUserPage;\n"]},"metadata":{},"sourceType":"module"}